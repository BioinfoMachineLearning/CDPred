# CDPred
## Function of CDPred
CDPred is a deep transformer tool for predicting interchain residue-residue distances of protein dimers. For a homodimer consiting of two identical units, it takes the tertiary structure of a unit of the homodimer and the multiple sequence alignment (MSA) of the unit as input to predict the residue-residue distances between the two identical units of the homodimer. For a heterodimer consisting of two different units, it takes the tertiary structures of the two units of the heterodimer and the MSA of the two units as input to predict residue-residue distances between the two units. If no MSA is available for dimer, users can use a script in this package to generate a MSA as input. The input is converted into numerical features that are used by 2D attention-based transformer networks to predict residue-residue distances between two units in a dimer. 

## System Requirements
### OS Requirements
This package is supported for Linux. The package has been tested on the following systems:
Linux: Ubuntu 16.04
Linux: CentOS Linux release 7.9.2009
### Python Dependencies
The system is developed and tested under Python 3.6.x. The main dependent packages and their versions are as follows. For more detail, please check the requirment.txt file.
```
fair-esm==0.3.1
Keras==2.1.6
matplotlib==3.3.4
numpy==1.16.2
tensorflow==1.9.0
```

## Installation guide
**(1) Download CDPred package (a short path for the package is recommended)**

```
git clone https://github.com/BioinfoMachineLearning/CDPred.git

cd CDPred
```

**(2) Install and activate Python 3.6.x environment on Linux (required)**

The installation of Python 3.6.x may be different for different Linux systems. 

```
mkdir env
python3.6 -m venv env/CDPred_virenv
source env/CDPred_virenv/bin/activate
pip install --upgrade pip
pip install -r requirments.txt
```
**(3) Download Uniref90**
Download the Uniref90_01_2020 database for PSSM generation
```
wget http://sysbio.rnet.missouri.edu/CDPred_db/uniref90_01_2020.tar.gz
tar -zxvf uniref90_01_2020.tar.gz
```
Modify the Uniref90 path in script ./lib/constants.py as /Download_Path/uniref90_01_2020/uniref90

The installation and configuration of the virtual environment lasts about 10 minutes (minor difference on different devices).
And the the Uniref90 database download will take about 40 minutes to 70 minutes, dependent on your network speed.

## Demo
### Instructions to run on example data

Demo1: Run CDPred on a homodimer target.

```
python lib/Model_predict.py -n T1084A_T1084B -p ./example/T1084A_T1084B.pdb -a ./example/T1084A_T1084B.a3m -m homodimer -o ./output/T1084A_T1084B/
```
The location of the pre-generated output files is ./example/expection_output/T1084A_T1084B/, and the location of the output file generated by your run is ./output/T1084A_T1084B/. The whole prediction process will last about 5 minutis

Demo2: Run CDPred on a heterodimer target.

```
python lib/Model_predict.py -n H1017A_H1017B -p ./example/H1017A.pdb ./example/H1017B.pdb -a ./example/H1017A_H1017B.a3m -m heterodimer -o ./output/H1017A_H1017B/
```
The location of the pre-generated output files is ./example/expection_output/H1017A_H1017B/, and the location of the output file generated by your run is ./output/H1017A_H1017B/. The whole prediction process will last about 5 minutis

## Running CDPred
### Predict homodimeric inter-chain distance map

```
python lib/Model_predict.py -n ProteinID -p pdb_file_list -a MSA_file(end in .a3m) -m homodimer -o output_path 
```

### Predict homodimeric inter-chain distance map

```
python lib/Model_predict.py -n ProteinID -p pdb_file_list -a MSA_file(end in .a3m) -m homodimer -o output_path 
```

## Output files
For both homodimer and heterodimer cases, the final prediction results will be stored in folder ./output/ProteinID/predmap/.
The inter-protein prediction distance map end in ProteinID.dist, the inter-protein prediction contact map end in ProteinID.htxt.
The expection output for the example located at ./example/expection_output/.

